<div class="cart-container">
  <!-- Background Shapes -->
  <div class="background-shapes">
    <div class="shape shape-1"></div>
    <div class="shape shape-2"></div>
    <div class="shape shape-3"></div>
  </div>

  <div class="container">
    <!-- Page Header -->
    <div class="page-header fade-in">
      <div class="header-content">
        <div class="header-icon">
          <i class="bi bi-cart3"></i>
        </div>
        <div class="header-text">
          <h1 class="page-title">Shopping Cart</h1>
          <p class="page-subtitle">Review and manage your items</p>
        </div>
      </div>
      <div class="cart-badge" *ngIf="cart.items.length > 0">
        <span class="badge-count">{{ cart.totalItems }}</span>
        <span class="badge-label">Items</span>
      </div>
    </div>

    <!-- Empty Cart State -->
    <div *ngIf="cart.items.length === 0" class="empty-cart-state fade-in">
      <div class="empty-cart-card">
        <div class="empty-icon">
          <i class="bi bi-cart-x"></i>
        </div>
        <h2>Your Cart is Empty</h2>
        <p>Looks like you haven't added any items to your cart yet. Start shopping to fill it up!</p>
        <a routerLink="/products" class="btn btn-shop-now">
          <i class="bi bi-shop"></i>
          Start Shopping
        </a>

        <div class="empty-features">
          <div class="feature-item">
            <i class="bi bi-truck"></i>
            <span>Free Shipping</span>
          </div>
          <div class="feature-item">
            <i class="bi bi-shield-check"></i>
            <span>Secure Payment</span>
          </div>
          <div class="feature-item">
            <i class="bi bi-arrow-clockwise"></i>
            <span>Easy Returns</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Cart Items -->
    <div *ngIf="cart.items.length > 0" class="cart-content">
      <div class="row">
        <!-- Cart Items List -->
        <div class="col-lg-8">
          <!-- Items Header -->
          <div class="items-header fade-in">
            <h3>
              <i class="bi bi-bag-check"></i>
              Your Items ({{ cart.items.length }})
            </h3>
            <button class="btn btn-clear-all" (click)="clearCart()">
              <i class="bi bi-trash"></i>
              Clear All
            </button>
          </div>

          <!-- Cart Item Cards -->
          <div class="cart-items-list">
            <div class="cart-item-card fade-in" *ngFor="let item of cart.items; let i = index" [style.animation-delay.ms]="i * 100">
              <!-- Product Image -->
              <div class="item-image-wrapper">
                <img
                  [src]="item.product.image"
                  [alt]="item.product.name"
                  class="item-image"
                  loading="lazy">
                <div class="image-overlay">
                  <a [routerLink]="['/products', item.product.id]" class="view-product">
                    <i class="bi bi-eye"></i>
                  </a>
                </div>
              </div>

              <!-- Product Details -->
              <div class="item-details">
                <div class="item-header">
                  <div class="item-info">
                    <h4 class="item-name">{{ item.product.name }}</h4>
                    <p class="item-category">
                      <i class="bi bi-tag"></i>
                      {{ item.product.category }}
                    </p>
                  </div>
                  <button class="btn-remove" (click)="removeItem(item.product.id)" title="Remove from cart">
                    <i class="bi bi-x-circle"></i>
                  </button>
                </div>

                <div class="item-footer">
                  <!-- Price -->
                  <div class="item-price">
                    <span class="price-label">Price</span>
                    <span class="price-value">${{ item.product.price.toFixed(2) }}</span>
                  </div>

                  <!-- Quantity Controls -->
                  <div class="quantity-control">
                    <span class="quantity-label">Quantity</span>
                    <div class="quantity-buttons">
                      <button
                        class="btn-quantity"
                        (click)="decreaseQuantity(item)"
                        [disabled]="item.quantity <= 1">
                        <i class="bi bi-dash"></i>
                      </button>
                      <input
                        type="text"
                        class="quantity-input"
                        [value]="item.quantity"
                        readonly>
                      <button
                        class="btn-quantity"
                        (click)="increaseQuantity(item)"
                        [disabled]="item.quantity >= item.product.stock">
                        <i class="bi bi-plus"></i>
                      </button>
                    </div>
                    <span class="stock-info" [class.low-stock]="item.product.stock < 10">
                      <i class="bi" [class.bi-check-circle]="item.product.stock >= 10" [class.bi-exclamation-circle]="item.product.stock < 10"></i>
                      {{ item.product.stock }} in stock
                    </span>
                  </div>

                  <!-- Subtotal -->
                  <div class="item-subtotal">
                    <span class="subtotal-label">Subtotal</span>
                    <span class="subtotal-value">${{ (item.product.price * item.quantity).toFixed(2) }}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Continue Shopping Button -->
          <div class="continue-shopping fade-in">
            <a routerLink="/products" class="btn btn-continue">
              <i class="bi bi-arrow-left"></i>
              Continue Shopping
            </a>
          </div>
        </div>

        <!-- Order Summary Sidebar -->
        <div class="col-lg-4">
          <div class="summary-card sticky-card fade-in">
            <!-- Summary Header -->
            <div class="summary-header">
              <i class="bi bi-receipt"></i>
              <h3>Order Summary</h3>
            </div>
            <!-- Price Breakdown -->
            <div class="price-breakdown">
              <div class="price-row">
                <span class="price-label">
                  <i class="bi bi-cart"></i>
                  Subtotal ({{ cart.totalItems }} items)
                </span>
                <span class="price-value">${{ cart.totalAmount.toFixed(2) }}</span>
              </div>
              <div class="price-row">
                <span class="price-label">
                  <i class="bi bi-receipt"></i>
                  Estimated Tax
                </span>
                <span class="price-value">${{ (cart.totalAmount * 0.1).toFixed(2) }}</span>
              </div>
            </div>

            <!-- Total Section -->
            <div class="total-section">
              <div class="total-row">
                <span class="total-label">Total</span>
                <span class="total-value">${{ (cart.totalAmount * 1.1).toFixed(2) }}</span>
              </div>
              <p class="total-note">
                <i class="bi bi-info-circle"></i>
                Final amount will be calculated at checkout
              </p>
            </div>

            <!-- Action Buttons -->
            <div class="action-buttons">
              <button class="btn btn-checkout" routerLink="/checkout">
                <i class="bi bi-credit-card"></i>
                Proceed to Checkout
              </button>
            </div>

            <!-- Trust Badges -->
            <div class="trust-badges">
              <div class="trust-item">
                <i class="bi bi-shield-fill-check"></i>
                <span>Secure Checkout</span>
              </div>
              <div class="trust-item">
                <i class="bi bi-truck"></i>
                <span>Free Shipping</span>
              </div>
              <div class="trust-item">
                <i class="bi bi-arrow-clockwise"></i>
                <span>30-Day Returns</span>
              </div>
            </div>

            <!-- Payment Methods -->
            <div class="payment-methods">
              <span class="payment-label">We Accept</span>
              <div class="payment-icons">
                <i class="bi bi-credit-card"></i>
                <i class="bi bi-paypal"></i>
                <i class="bi bi-apple"></i>
                <i class="bi bi-google"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Success Toast (for item removed/updated) -->
  <div class="success-toast" *ngIf="showSuccessToast">
    <div class="toast-content">
      <i class="bi bi-check-circle-fill"></i>
      <span>{{ successMessage }}</span>
    </div>
  </div>
</div>
